#!/usr/bin/env zsh

local function USAGE() {
    echo "usage: $0 <project name> <project template>"
    echo
    echo "available templates:"
    ls "$HOME/.templates"
}

if [[ -z $1 ]]; then
    USAGE
    exit 1
fi

if [[ -z $2 || ! -e "$HOME/.templates/$2" ]]; then
    USAGE
    exit 1
fi

mkdir -p "$HOME/data/projects/$1/repo"

cd "$HOME/data/projects/$1"

cp "$HOME/.templates/$2"/* .



echo "#!/usr/bin/env zsh

export PATH_NOPROJ=$(echo -n '${PATH_NOPROJ:-$PATH}')

export PATH=$PWD:$(echo -n '$PATH_NOPROJ')
export PROJECT=$1
export PROJECT_DIR=$PWD" > sourceme

chmod +x sourceme

[[ -x setup ]] && ./setup

cd repo
